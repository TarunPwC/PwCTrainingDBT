
  
    

create or replace table EMART_OMS.L2_PROCESSING.ORDER_FACT
    

    
    as (SELECT
    O.ORDERID,
    O.ORDERDATE,
    O.CUSTOMERID,
    O.EMPLOYEEID,
    O.STOREID,
    O.STATUSCD,
    O.STATUSDESC,
    O.UPDATED_AT,
    COUNT(DISTINCT O.ORDERID) AS ORDERCOUNT,
    SUM(OI.TOTALPRICE) AS REVENUE
    FROM 
        EMART_OMS.L2_PROCESSING.ORDER_STG O
    JOIN
        EMART_OMS.L2_PROCESSING.ORDERITEM_STG OI   
    ON O.ORDERID = OI.ORDERID
    GROUP BY
    O.ORDERID,
    O.ORDERDATE,
    O.CUSTOMERID,
    O.EMPLOYEEID,
    O.STOREID,
    O.STATUSCD,
    O.STATUSDESC,
    O.UPDATED_AT
    )
;


  